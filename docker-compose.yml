services:
  selenium:
    image: selenium/standalone-chrome:latest
    shm_size: 512m
    ports:
      - "4444:4444"

  dagster:
    image: dagster/dagster:latest
    environment:
      - DAGSTER_HOME=/opt/dagster/dagster_home
      - SELENIUM_REMOTE_URL=http://selenium:4444/wd/hub
    volumes:
      - /home/ubuntu/work/repo_dagster:/opt/dagster/app
      - ./dagster_home:/opt/dagster/dagster_home
      - ./data:/opt/dagster/data
      # añade aquí tu repo del scraper:
      # - /home/ubuntu/work/<repo_scraper>:/opt/scraper
    ports:
      - "8080:3000"
    depends_on:
      - selenium
    command: >
      bash -lc "
      pip install --no-cache-dir selenium &&
      dagster-webserver -h 0.0.0.0 -p 3000 -f /opt/dagster/app/__init__.py
      "
